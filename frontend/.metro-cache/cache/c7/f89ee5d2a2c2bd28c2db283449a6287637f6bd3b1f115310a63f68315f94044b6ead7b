{"dependencies":[{"name":"@reduxjs/toolkit","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":31},"end":{"line":2,"column":65,"index":96}}],"key":"54oW2xbJyHE290wIe7uf9enEy7w=","exportNames":["*"],"imports":1}},{"name":"../../core/data/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":157},"end":{"line":4,"column":57,"index":214}}],"key":"LKbs5eRhj6tjbfzVwNzjGvjnujc=","exportNames":["*"],"imports":1}},{"name":"../../core/common/constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":215},"end":{"line":5,"column":53,"index":268}}],"key":"itg34BM/WgAWR0dubXmK9Thb4Dw=","exportNames":["*"],"imports":1}},{"name":"../../core/common/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":269},"end":{"line":6,"column":54,"index":323}}],"key":"/2smbr+GDMmCuGIULHqprsQtHd8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"loadGamification\", {\n    enumerable: true,\n    get: function () {\n      return loadGamification;\n    }\n  });\n  Object.defineProperty(exports, \"awardPoints\", {\n    enumerable: true,\n    get: function () {\n      return awardPoints;\n    }\n  });\n  Object.defineProperty(exports, \"updateStreak\", {\n    enumerable: true,\n    get: function () {\n      return updateStreak;\n    }\n  });\n  var _reduxjsToolkit = require(_dependencyMap[0], \"@reduxjs/toolkit\");\n  var _coreDataStorage = require(_dependencyMap[1], \"../../core/data/storage\");\n  var _coreCommonConstants = require(_dependencyMap[2], \"../../core/common/constants\");\n  var _coreCommonUtils = require(_dependencyMap[3], \"../../core/common/utils\");\n  // ðŸŽ® Gamification Redux Slice\n\n  const initialState = {\n    points: 0,\n    level: 1,\n    currentStreak: 0,\n    longestStreak: 0,\n    lastLogDate: null,\n    badges: [],\n    totalTransactions: 0\n  };\n\n  // Async thunks\n  const loadGamification = (0, _reduxjsToolkit.createAsyncThunk)('gamification/load', async () => {\n    const data = await _coreDataStorage.storageService.getGamification();\n    return data || initialState;\n  });\n  const awardPoints = (0, _reduxjsToolkit.createAsyncThunk)('gamification/awardPoints', async (points, {\n    getState\n  }) => {\n    const state = getState();\n    const updatedState = {\n      ...state.gamification,\n      points: state.gamification.points + points\n    };\n\n    // Level up every 500 points\n    updatedState.level = Math.floor(updatedState.points / 500) + 1;\n    await _coreDataStorage.storageService.saveGamification(updatedState);\n    return updatedState;\n  });\n  const updateStreak = (0, _reduxjsToolkit.createAsyncThunk)('gamification/updateStreak', async (_, {\n    getState\n  }) => {\n    const state = getState();\n    const {\n      lastLogDate,\n      currentStreak,\n      longestStreak\n    } = state.gamification;\n    let newStreak = currentStreak;\n    let awardedPoints = 0;\n    if (!lastLogDate) {\n      // First log ever\n      newStreak = 1;\n      awardedPoints = _coreCommonConstants.POINTS.DAILY_STREAK;\n    } else if (!(0, _coreCommonUtils.isTodayDate)(lastLogDate)) {\n      // New day\n      newStreak = currentStreak + 1;\n      awardedPoints = _coreCommonConstants.POINTS.DAILY_STREAK;\n    }\n    const newLongestStreak = Math.max(longestStreak, newStreak);\n    const updatedState = {\n      ...state.gamification,\n      currentStreak: newStreak,\n      longestStreak: newLongestStreak,\n      lastLogDate: new Date().toISOString(),\n      points: state.gamification.points + awardedPoints,\n      totalTransactions: state.gamification.totalTransactions + 1\n    };\n    await _coreDataStorage.storageService.saveGamification(updatedState);\n    return updatedState;\n  });\n  const gamificationSlice = (0, _reduxjsToolkit.createSlice)({\n    name: 'gamification',\n    initialState,\n    reducers: {},\n    extraReducers: builder => {\n      builder.addCase(loadGamification.fulfilled, (state, action) => {\n        return action.payload;\n      }).addCase(awardPoints.fulfilled, (state, action) => {\n        return action.payload;\n      }).addCase(updateStreak.fulfilled, (state, action) => {\n        return action.payload;\n      });\n    }\n  });\n  var _default = gamificationSlice.reducer;\n});","lineCount":113,"map":[[7,2,97,0,"Object"],[7,8,97,0],[7,9,97,0,"defineProperty"],[7,23,97,0],[7,24,97,0,"exports"],[7,31,97,0],[8,4,97,0,"enumerable"],[8,14,97,0],[9,4,97,0,"get"],[9,7,97,0],[9,18,97,0,"get"],[9,19,97,0],[10,6,97,0],[10,13,97,0,"_default"],[10,21,97,0],[11,4,97,0],[12,2,97,0],[13,2,19,0,"Object"],[13,8,19,0],[13,9,19,0,"defineProperty"],[13,23,19,0],[13,24,19,0,"exports"],[13,31,19,0],[14,4,19,0,"enumerable"],[14,14,19,0],[15,4,19,0,"get"],[15,7,19,0],[15,18,19,0,"get"],[15,19,19,0],[16,6,19,0],[16,13,19,0,"loadGamification"],[16,29,19,0],[17,4,19,0],[18,2,19,0],[19,2,27,0,"Object"],[19,8,27,0],[19,9,27,0,"defineProperty"],[19,23,27,0],[19,24,27,0,"exports"],[19,31,27,0],[20,4,27,0,"enumerable"],[20,14,27,0],[21,4,27,0,"get"],[21,7,27,0],[21,18,27,0,"get"],[21,19,27,0],[22,6,27,0],[22,13,27,0,"awardPoints"],[22,24,27,0],[23,4,27,0],[24,2,27,0],[25,2,44,0,"Object"],[25,8,44,0],[25,9,44,0,"defineProperty"],[25,23,44,0],[25,24,44,0,"exports"],[25,31,44,0],[26,4,44,0,"enumerable"],[26,14,44,0],[27,4,44,0,"get"],[27,7,44,0],[27,18,44,0,"get"],[27,19,44,0],[28,6,44,0],[28,13,44,0,"updateStreak"],[28,25,44,0],[29,4,44,0],[30,2,44,0],[31,2,2,0],[31,6,2,0,"_reduxjsToolkit"],[31,21,2,0],[31,24,2,0,"require"],[31,31,2,0],[31,32,2,0,"_dependencyMap"],[31,46,2,0],[32,2,4,0],[32,6,4,0,"_coreDataStorage"],[32,22,4,0],[32,25,4,0,"require"],[32,32,4,0],[32,33,4,0,"_dependencyMap"],[32,47,4,0],[33,2,5,0],[33,6,5,0,"_coreCommonConstants"],[33,26,5,0],[33,29,5,0,"require"],[33,36,5,0],[33,37,5,0,"_dependencyMap"],[33,51,5,0],[34,2,6,0],[34,6,6,0,"_coreCommonUtils"],[34,22,6,0],[34,25,6,0,"require"],[34,32,6,0],[34,33,6,0,"_dependencyMap"],[34,47,6,0],[35,2,1,0],[37,2,8,0],[37,8,8,6,"initialState"],[37,20,8,37],[37,23,8,40],[38,4,9,2,"points"],[38,10,9,8],[38,12,9,10],[38,13,9,11],[39,4,10,2,"level"],[39,9,10,7],[39,11,10,9],[39,12,10,10],[40,4,11,2,"currentStreak"],[40,17,11,15],[40,19,11,17],[40,20,11,18],[41,4,12,2,"longestStreak"],[41,17,12,15],[41,19,12,17],[41,20,12,18],[42,4,13,2,"lastLogDate"],[42,15,13,13],[42,17,13,15],[42,21,13,19],[43,4,14,2,"badges"],[43,10,14,8],[43,12,14,10],[43,14,14,12],[44,4,15,2,"totalTransactions"],[44,21,15,19],[44,23,15,21],[45,2,16,0],[45,3,16,1],[47,2,18,0],[48,2,19,7],[48,8,19,13,"loadGamification"],[48,24,19,29],[48,27,19,32],[48,31,19,32,"createAsyncThunk"],[48,46,19,48],[48,47,19,48,"createAsyncThunk"],[48,63,19,48],[48,65,20,2],[48,84,20,21],[48,86,21,2],[48,98,21,14],[49,4,22,4],[49,10,22,10,"data"],[49,14,22,14],[49,17,22,17],[49,23,22,23,"storageService"],[49,39,22,37],[49,40,22,37,"storageService"],[49,54,22,37],[49,55,22,38,"getGamification"],[49,70,22,53],[49,71,22,54],[49,72,22,55],[50,4,23,4],[50,11,23,11,"data"],[50,15,23,15],[50,19,23,19,"initialState"],[50,31,23,31],[51,2,24,2],[51,3,25,0],[51,4,25,1],[52,2,27,7],[52,8,27,13,"awardPoints"],[52,19,27,24],[52,22,27,27],[52,26,27,27,"createAsyncThunk"],[52,41,27,43],[52,42,27,43,"createAsyncThunk"],[52,58,27,43],[52,60,28,2],[52,86,28,28],[52,88,29,2],[52,95,29,9,"points"],[52,101,29,23],[52,103,29,25],[53,4,29,27,"getState"],[54,2,29,36],[54,3,29,37],[54,8,29,42],[55,4,30,4],[55,10,30,10,"state"],[55,15,30,15],[55,18,30,18,"getState"],[55,26,30,26],[55,27,30,27],[55,28,30,67],[56,4,31,4],[56,10,31,10,"updatedState"],[56,22,31,22],[56,25,31,25],[57,6,32,6],[57,9,32,9,"state"],[57,14,32,14],[57,15,32,15,"gamification"],[57,27,32,27],[58,6,33,6,"points"],[58,12,33,12],[58,14,33,14,"state"],[58,19,33,19],[58,20,33,20,"gamification"],[58,32,33,32],[58,33,33,33,"points"],[58,39,33,39],[58,42,33,42,"points"],[59,4,34,4],[59,5,34,5],[61,4,36,4],[62,4,37,4,"updatedState"],[62,16,37,16],[62,17,37,17,"level"],[62,22,37,22],[62,25,37,25,"Math"],[62,29,37,29],[62,30,37,30,"floor"],[62,35,37,35],[62,36,37,36,"updatedState"],[62,48,37,48],[62,49,37,49,"points"],[62,55,37,55],[62,58,37,58],[62,61,37,61],[62,62,37,62],[62,65,37,65],[62,66,37,66],[63,4,39,4],[63,10,39,10,"storageService"],[63,26,39,24],[63,27,39,24,"storageService"],[63,41,39,24],[63,42,39,25,"saveGamification"],[63,58,39,41],[63,59,39,42,"updatedState"],[63,71,39,54],[63,72,39,55],[64,4,40,4],[64,11,40,11,"updatedState"],[64,23,40,23],[65,2,41,2],[65,3,42,0],[65,4,42,1],[66,2,44,7],[66,8,44,13,"updateStreak"],[66,20,44,25],[66,23,44,28],[66,27,44,28,"createAsyncThunk"],[66,42,44,44],[66,43,44,44,"createAsyncThunk"],[66,59,44,44],[66,61,45,2],[66,88,45,29],[66,90,46,2],[66,97,46,9,"_"],[66,98,46,10],[66,100,46,12],[67,4,46,14,"getState"],[68,2,46,23],[68,3,46,24],[68,8,46,29],[69,4,47,4],[69,10,47,10,"state"],[69,15,47,15],[69,18,47,18,"getState"],[69,26,47,26],[69,27,47,27],[69,28,47,67],[70,4,48,4],[70,10,48,10],[71,6,48,12,"lastLogDate"],[71,17,48,23],[72,6,48,25,"currentStreak"],[72,19,48,38],[73,6,48,40,"longestStreak"],[74,4,48,54],[74,5,48,55],[74,8,48,58,"state"],[74,13,48,63],[74,14,48,64,"gamification"],[74,26,48,76],[75,4,50,4],[75,8,50,8,"newStreak"],[75,17,50,17],[75,20,50,20,"currentStreak"],[75,33,50,33],[76,4,51,4],[76,8,51,8,"awardedPoints"],[76,21,51,21],[76,24,51,24],[76,25,51,25],[77,4,53,4],[77,8,53,8],[77,9,53,9,"lastLogDate"],[77,20,53,20],[77,22,53,22],[78,6,54,6],[79,6,55,6,"newStreak"],[79,15,55,15],[79,18,55,18],[79,19,55,19],[80,6,56,6,"awardedPoints"],[80,19,56,19],[80,22,56,22,"POINTS"],[80,42,56,28],[80,43,56,28,"POINTS"],[80,49,56,28],[80,50,56,29,"DAILY_STREAK"],[80,62,56,41],[81,4,57,4],[81,5,57,5],[81,11,57,11],[81,15,57,15],[81,16,57,16],[81,20,57,16,"isTodayDate"],[81,36,57,27],[81,37,57,27,"isTodayDate"],[81,48,57,27],[81,50,57,28,"lastLogDate"],[81,61,57,39],[81,62,57,40],[81,64,57,42],[82,6,58,6],[83,6,59,6,"newStreak"],[83,15,59,15],[83,18,59,18,"currentStreak"],[83,31,59,31],[83,34,59,34],[83,35,59,35],[84,6,60,6,"awardedPoints"],[84,19,60,19],[84,22,60,22,"POINTS"],[84,42,60,28],[84,43,60,28,"POINTS"],[84,49,60,28],[84,50,60,29,"DAILY_STREAK"],[84,62,60,41],[85,4,61,4],[86,4,63,4],[86,10,63,10,"newLongestStreak"],[86,26,63,26],[86,29,63,29,"Math"],[86,33,63,33],[86,34,63,34,"max"],[86,37,63,37],[86,38,63,38,"longestStreak"],[86,51,63,51],[86,53,63,53,"newStreak"],[86,62,63,62],[86,63,63,63],[87,4,65,4],[87,10,65,10,"updatedState"],[87,22,65,22],[87,25,65,25],[88,6,66,6],[88,9,66,9,"state"],[88,14,66,14],[88,15,66,15,"gamification"],[88,27,66,27],[89,6,67,6,"currentStreak"],[89,19,67,19],[89,21,67,21,"newStreak"],[89,30,67,30],[90,6,68,6,"longestStreak"],[90,19,68,19],[90,21,68,21,"newLongestStreak"],[90,37,68,37],[91,6,69,6,"lastLogDate"],[91,17,69,17],[91,19,69,19],[91,23,69,23,"Date"],[91,27,69,27],[91,28,69,28],[91,29,69,29],[91,30,69,30,"toISOString"],[91,41,69,41],[91,42,69,42],[91,43,69,43],[92,6,70,6,"points"],[92,12,70,12],[92,14,70,14,"state"],[92,19,70,19],[92,20,70,20,"gamification"],[92,32,70,32],[92,33,70,33,"points"],[92,39,70,39],[92,42,70,42,"awardedPoints"],[92,55,70,55],[93,6,71,6,"totalTransactions"],[93,23,71,23],[93,25,71,25,"state"],[93,30,71,30],[93,31,71,31,"gamification"],[93,43,71,43],[93,44,71,44,"totalTransactions"],[93,61,71,61],[93,64,71,64],[94,4,72,4],[94,5,72,5],[95,4,74,4],[95,10,74,10,"storageService"],[95,26,74,24],[95,27,74,24,"storageService"],[95,41,74,24],[95,42,74,25,"saveGamification"],[95,58,74,41],[95,59,74,42,"updatedState"],[95,71,74,54],[95,72,74,55],[96,4,75,4],[96,11,75,11,"updatedState"],[96,23,75,23],[97,2,76,2],[97,3,77,0],[97,4,77,1],[98,2,79,0],[98,8,79,6,"gamificationSlice"],[98,25,79,23],[98,28,79,26],[98,32,79,26,"createSlice"],[98,47,79,37],[98,48,79,37,"createSlice"],[98,59,79,37],[98,61,79,38],[99,4,80,2,"name"],[99,8,80,6],[99,10,80,8],[99,24,80,22],[100,4,81,2,"initialState"],[100,16,81,14],[101,4,82,2,"reducers"],[101,12,82,10],[101,14,82,12],[101,15,82,13],[101,16,82,14],[102,4,83,2,"extraReducers"],[102,17,83,15],[102,19,83,18,"builder"],[102,26,83,25],[102,30,83,30],[103,6,84,4,"builder"],[103,13,84,11],[103,14,85,7,"addCase"],[103,21,85,14],[103,22,85,15,"loadGamification"],[103,38,85,31],[103,39,85,32,"fulfilled"],[103,48,85,41],[103,50,85,43],[103,51,85,44,"state"],[103,56,85,49],[103,58,85,51,"action"],[103,64,85,57],[103,69,85,62],[104,8,86,8],[104,15,86,15,"action"],[104,21,86,21],[104,22,86,22,"payload"],[104,29,86,29],[105,6,87,6],[105,7,87,7],[105,8,87,8],[105,9,88,7,"addCase"],[105,16,88,14],[105,17,88,15,"awardPoints"],[105,28,88,26],[105,29,88,27,"fulfilled"],[105,38,88,36],[105,40,88,38],[105,41,88,39,"state"],[105,46,88,44],[105,48,88,46,"action"],[105,54,88,52],[105,59,88,57],[106,8,89,8],[106,15,89,15,"action"],[106,21,89,21],[106,22,89,22,"payload"],[106,29,89,29],[107,6,90,6],[107,7,90,7],[107,8,90,8],[107,9,91,7,"addCase"],[107,16,91,14],[107,17,91,15,"updateStreak"],[107,29,91,27],[107,30,91,28,"fulfilled"],[107,39,91,37],[107,41,91,39],[107,42,91,40,"state"],[107,47,91,45],[107,49,91,47,"action"],[107,55,91,53],[107,60,91,58],[108,8,92,8],[108,15,92,15,"action"],[108,21,92,21],[108,22,92,22,"payload"],[108,29,92,29],[109,6,93,6],[109,7,93,7],[109,8,93,8],[110,4,94,2],[111,2,95,0],[111,3,95,1],[111,4,95,2],[112,2,97,0],[112,6,97,0,"_default"],[112,14,97,0],[112,17,97,15,"gamificationSlice"],[112,34,97,32],[112,35,97,33,"reducer"],[112,42,97,40],[113,0,97,41],[113,3]],"functionMap":{"names":["<global>","createAsyncThunk$argument_1","createSlice$argument_0.extraReducers","builder.addCase$argument_1","builder.addCase.addCase$argument_1","builder.addCase.addCase.addCase$argument_1"],"mappings":"AAA;ECoB;GDG;ECK;GDY;ECK;GD8B;iBEO;2CCE;ODE;sCEC;OFE;uCGC;OHE;GFC"},"hasCjsExports":false},"type":"js/module"}]}