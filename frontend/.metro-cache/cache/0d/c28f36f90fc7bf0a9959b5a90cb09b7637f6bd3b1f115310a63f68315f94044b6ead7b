{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@reduxjs/toolkit","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":31},"end":{"line":2,"column":65,"index":96}}],"key":"54oW2xbJyHE290wIe7uf9enEy7w=","exportNames":["*"],"imports":1}},{"name":"../../core/data/storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":157},"end":{"line":4,"column":57,"index":214}}],"key":"LKbs5eRhj6tjbfzVwNzjGvjnujc=","exportNames":["*"],"imports":1}},{"name":"../../core/common/constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":215},"end":{"line":5,"column":53,"index":268}}],"key":"itg34BM/WgAWR0dubXmK9Thb4Dw=","exportNames":["*"],"imports":1}},{"name":"../../core/common/utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":269},"end":{"line":6,"column":54,"index":323}}],"key":"/2smbr+GDMmCuGIULHqprsQtHd8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"loadGamification\", {\n    enumerable: true,\n    get: function () {\n      return loadGamification;\n    }\n  });\n  Object.defineProperty(exports, \"awardPoints\", {\n    enumerable: true,\n    get: function () {\n      return awardPoints;\n    }\n  });\n  Object.defineProperty(exports, \"updateStreak\", {\n    enumerable: true,\n    get: function () {\n      return updateStreak;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _reduxjsToolkit = require(_dependencyMap[1], \"@reduxjs/toolkit\");\n  var _coreDataStorage = require(_dependencyMap[2], \"../../core/data/storage\");\n  var _coreCommonConstants = require(_dependencyMap[3], \"../../core/common/constants\");\n  var _coreCommonUtils = require(_dependencyMap[4], \"../../core/common/utils\");\n  // ðŸŽ® Gamification Redux Slice\n\n  var initialState = {\n    points: 0,\n    level: 1,\n    currentStreak: 0,\n    longestStreak: 0,\n    lastLogDate: null,\n    badges: [],\n    totalTransactions: 0\n  };\n\n  // Async thunks\n  var loadGamification = (0, _reduxjsToolkit.createAsyncThunk)('gamification/load', /*#__PURE__*/(0, _asyncToGenerator.default)(function* () {\n    var data = yield _coreDataStorage.storageService.getGamification();\n    return data || initialState;\n  }));\n  var awardPoints = (0, _reduxjsToolkit.createAsyncThunk)('gamification/awardPoints', /*#__PURE__*/function () {\n    var _ref3 = (0, _asyncToGenerator.default)(function* (points, _ref2) {\n      var getState = _ref2.getState;\n      var state = getState();\n      var updatedState = {\n        ...state.gamification,\n        points: state.gamification.points + points\n      };\n\n      // Level up every 500 points\n      updatedState.level = Math.floor(updatedState.points / 500) + 1;\n      yield _coreDataStorage.storageService.saveGamification(updatedState);\n      return updatedState;\n    });\n    return function (_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n  var updateStreak = (0, _reduxjsToolkit.createAsyncThunk)('gamification/updateStreak', /*#__PURE__*/function () {\n    var _ref5 = (0, _asyncToGenerator.default)(function* (_, _ref4) {\n      var getState = _ref4.getState;\n      var state = getState();\n      var _state$gamification = state.gamification,\n        lastLogDate = _state$gamification.lastLogDate,\n        currentStreak = _state$gamification.currentStreak,\n        longestStreak = _state$gamification.longestStreak;\n      var newStreak = currentStreak;\n      var awardedPoints = 0;\n      if (!lastLogDate) {\n        // First log ever\n        newStreak = 1;\n        awardedPoints = _coreCommonConstants.POINTS.DAILY_STREAK;\n      } else if (!(0, _coreCommonUtils.isTodayDate)(lastLogDate)) {\n        // New day\n        newStreak = currentStreak + 1;\n        awardedPoints = _coreCommonConstants.POINTS.DAILY_STREAK;\n      }\n      var newLongestStreak = Math.max(longestStreak, newStreak);\n      var updatedState = {\n        ...state.gamification,\n        currentStreak: newStreak,\n        longestStreak: newLongestStreak,\n        lastLogDate: new Date().toISOString(),\n        points: state.gamification.points + awardedPoints,\n        totalTransactions: state.gamification.totalTransactions + 1\n      };\n      yield _coreDataStorage.storageService.saveGamification(updatedState);\n      return updatedState;\n    });\n    return function (_x3, _x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n  var gamificationSlice = (0, _reduxjsToolkit.createSlice)({\n    name: 'gamification',\n    initialState,\n    reducers: {},\n    extraReducers: builder => {\n      builder.addCase(loadGamification.fulfilled, (state, action) => {\n        return action.payload;\n      }).addCase(awardPoints.fulfilled, (state, action) => {\n        return action.payload;\n      }).addCase(updateStreak.fulfilled, (state, action) => {\n        return action.payload;\n      });\n    }\n  });\n  var _default = gamificationSlice.reducer;\n});","lineCount":127,"map":[[12,2,97,0,"Object"],[12,8,97,0],[12,9,97,0,"defineProperty"],[12,23,97,0],[12,24,97,0,"exports"],[12,31,97,0],[13,4,97,0,"enumerable"],[13,14,97,0],[14,4,97,0,"get"],[14,7,97,0],[14,18,97,0,"get"],[14,19,97,0],[15,6,97,0],[15,13,97,0,"_default"],[15,21,97,0],[16,4,97,0],[17,2,97,0],[18,2,19,0,"Object"],[18,8,19,0],[18,9,19,0,"defineProperty"],[18,23,19,0],[18,24,19,0,"exports"],[18,31,19,0],[19,4,19,0,"enumerable"],[19,14,19,0],[20,4,19,0,"get"],[20,7,19,0],[20,18,19,0,"get"],[20,19,19,0],[21,6,19,0],[21,13,19,0,"loadGamification"],[21,29,19,0],[22,4,19,0],[23,2,19,0],[24,2,27,0,"Object"],[24,8,27,0],[24,9,27,0,"defineProperty"],[24,23,27,0],[24,24,27,0,"exports"],[24,31,27,0],[25,4,27,0,"enumerable"],[25,14,27,0],[26,4,27,0,"get"],[26,7,27,0],[26,18,27,0,"get"],[26,19,27,0],[27,6,27,0],[27,13,27,0,"awardPoints"],[27,24,27,0],[28,4,27,0],[29,2,27,0],[30,2,44,0,"Object"],[30,8,44,0],[30,9,44,0,"defineProperty"],[30,23,44,0],[30,24,44,0,"exports"],[30,31,44,0],[31,4,44,0,"enumerable"],[31,14,44,0],[32,4,44,0,"get"],[32,7,44,0],[32,18,44,0,"get"],[32,19,44,0],[33,6,44,0],[33,13,44,0,"updateStreak"],[33,25,44,0],[34,4,44,0],[35,2,44,0],[36,2,77,2],[36,6,77,2,"_babelRuntimeHelpersAsyncToGenerator"],[36,42,77,2],[36,45,77,2,"require"],[36,52,77,2],[36,53,77,2,"_dependencyMap"],[36,67,77,2],[37,2,77,2],[37,6,77,2,"_asyncToGenerator"],[37,23,77,2],[37,26,77,2,"_interopDefault"],[37,41,77,2],[37,42,77,2,"_babelRuntimeHelpersAsyncToGenerator"],[37,78,77,2],[38,2,2,0],[38,6,2,0,"_reduxjsToolkit"],[38,21,2,0],[38,24,2,0,"require"],[38,31,2,0],[38,32,2,0,"_dependencyMap"],[38,46,2,0],[39,2,4,0],[39,6,4,0,"_coreDataStorage"],[39,22,4,0],[39,25,4,0,"require"],[39,32,4,0],[39,33,4,0,"_dependencyMap"],[39,47,4,0],[40,2,5,0],[40,6,5,0,"_coreCommonConstants"],[40,26,5,0],[40,29,5,0,"require"],[40,36,5,0],[40,37,5,0,"_dependencyMap"],[40,51,5,0],[41,2,6,0],[41,6,6,0,"_coreCommonUtils"],[41,22,6,0],[41,25,6,0,"require"],[41,32,6,0],[41,33,6,0,"_dependencyMap"],[41,47,6,0],[42,2,1,0],[44,2,8,0],[44,6,8,6,"initialState"],[44,18,8,37],[44,21,8,40],[45,4,9,2,"points"],[45,10,9,8],[45,12,9,10],[45,13,9,11],[46,4,10,2,"level"],[46,9,10,7],[46,11,10,9],[46,12,10,10],[47,4,11,2,"currentStreak"],[47,17,11,15],[47,19,11,17],[47,20,11,18],[48,4,12,2,"longestStreak"],[48,17,12,15],[48,19,12,17],[48,20,12,18],[49,4,13,2,"lastLogDate"],[49,15,13,13],[49,17,13,15],[49,21,13,19],[50,4,14,2,"badges"],[50,10,14,8],[50,12,14,10],[50,14,14,12],[51,4,15,2,"totalTransactions"],[51,21,15,19],[51,23,15,21],[52,2,16,0],[52,3,16,1],[54,2,18,0],[55,2,19,7],[55,6,19,13,"loadGamification"],[55,22,19,29],[55,25,19,32],[55,29,19,32,"createAsyncThunk"],[55,44,19,48],[55,45,19,48,"createAsyncThunk"],[55,61,19,48],[55,63,20,2],[55,82,20,21],[55,101,20,21,"_asyncToGenerator"],[55,118,20,21],[55,119,20,21,"default"],[55,126,20,21],[55,128,21,2],[55,141,21,14],[56,4,22,4],[56,8,22,10,"data"],[56,12,22,14],[56,21,22,23,"storageService"],[56,37,22,37],[56,38,22,37,"storageService"],[56,52,22,37],[56,53,22,38,"getGamification"],[56,68,22,53],[56,69,22,54],[56,70,22,55],[57,4,23,4],[57,11,23,11,"data"],[57,15,23,15],[57,19,23,19,"initialState"],[57,31,23,31],[58,2,24,2],[58,3,24,3],[58,4,25,0],[58,5,25,1],[59,2,27,7],[59,6,27,13,"awardPoints"],[59,17,27,24],[59,20,27,27],[59,24,27,27,"createAsyncThunk"],[59,39,27,43],[59,40,27,43,"createAsyncThunk"],[59,56,27,43],[59,58,28,2],[59,84,28,28],[60,4,28,28],[60,8,28,28,"_ref3"],[60,13,28,28],[60,20,28,28,"_asyncToGenerator"],[60,37,28,28],[60,38,28,28,"default"],[60,45,28,28],[60,47,29,2],[60,58,29,9,"points"],[60,64,29,23],[60,66,29,23,"_ref2"],[60,71,29,23],[60,73,29,42],[61,6,29,42],[61,10,29,27,"getState"],[61,18,29,35],[61,21,29,35,"_ref2"],[61,26,29,35],[61,27,29,27,"getState"],[61,35,29,35],[62,6,30,4],[62,10,30,10,"state"],[62,15,30,15],[62,18,30,18,"getState"],[62,26,30,26],[62,27,30,27],[62,28,30,67],[63,6,31,4],[63,10,31,10,"updatedState"],[63,22,31,22],[63,25,31,25],[64,8,32,6],[64,11,32,9,"state"],[64,16,32,14],[64,17,32,15,"gamification"],[64,29,32,27],[65,8,33,6,"points"],[65,14,33,12],[65,16,33,14,"state"],[65,21,33,19],[65,22,33,20,"gamification"],[65,34,33,32],[65,35,33,33,"points"],[65,41,33,39],[65,44,33,42,"points"],[66,6,34,4],[66,7,34,5],[68,6,36,4],[69,6,37,4,"updatedState"],[69,18,37,16],[69,19,37,17,"level"],[69,24,37,22],[69,27,37,25,"Math"],[69,31,37,29],[69,32,37,30,"floor"],[69,37,37,35],[69,38,37,36,"updatedState"],[69,50,37,48],[69,51,37,49,"points"],[69,57,37,55],[69,60,37,58],[69,63,37,61],[69,64,37,62],[69,67,37,65],[69,68,37,66],[70,6,39,4],[70,12,39,10,"storageService"],[70,28,39,24],[70,29,39,24,"storageService"],[70,43,39,24],[70,44,39,25,"saveGamification"],[70,60,39,41],[70,61,39,42,"updatedState"],[70,73,39,54],[70,74,39,55],[71,6,40,4],[71,13,40,11,"updatedState"],[71,25,40,23],[72,4,41,2],[72,5,41,3],[73,4,41,3],[73,21,41,3,"_x"],[73,23,41,3],[73,25,41,3,"_x2"],[73,28,41,3],[74,6,41,3],[74,13,41,3,"_ref3"],[74,18,41,3],[74,19,41,3,"apply"],[74,24,41,3],[74,31,41,3,"arguments"],[74,40,41,3],[75,4,41,3],[76,2,41,3],[76,5,42,0],[76,6,42,1],[77,2,44,7],[77,6,44,13,"updateStreak"],[77,18,44,25],[77,21,44,28],[77,25,44,28,"createAsyncThunk"],[77,40,44,44],[77,41,44,44,"createAsyncThunk"],[77,57,44,44],[77,59,45,2],[77,86,45,29],[78,4,45,29],[78,8,45,29,"_ref5"],[78,13,45,29],[78,20,45,29,"_asyncToGenerator"],[78,37,45,29],[78,38,45,29,"default"],[78,45,45,29],[78,47,46,2],[78,58,46,9,"_"],[78,59,46,10],[78,61,46,10,"_ref4"],[78,66,46,10],[78,68,46,29],[79,6,46,29],[79,10,46,14,"getState"],[79,18,46,22],[79,21,46,22,"_ref4"],[79,26,46,22],[79,27,46,14,"getState"],[79,35,46,22],[80,6,47,4],[80,10,47,10,"state"],[80,15,47,15],[80,18,47,18,"getState"],[80,26,47,26],[80,27,47,27],[80,28,47,67],[81,6,48,4],[81,10,48,4,"_state$gamification"],[81,29,48,4],[81,32,48,58,"state"],[81,37,48,63],[81,38,48,64,"gamification"],[81,50,48,76],[82,8,48,12,"lastLogDate"],[82,19,48,23],[82,22,48,23,"_state$gamification"],[82,41,48,23],[82,42,48,12,"lastLogDate"],[82,53,48,23],[83,8,48,25,"currentStreak"],[83,21,48,38],[83,24,48,38,"_state$gamification"],[83,43,48,38],[83,44,48,25,"currentStreak"],[83,57,48,38],[84,8,48,40,"longestStreak"],[84,21,48,53],[84,24,48,53,"_state$gamification"],[84,43,48,53],[84,44,48,40,"longestStreak"],[84,57,48,53],[85,6,50,4],[85,10,50,8,"newStreak"],[85,19,50,17],[85,22,50,20,"currentStreak"],[85,35,50,33],[86,6,51,4],[86,10,51,8,"awardedPoints"],[86,23,51,21],[86,26,51,24],[86,27,51,25],[87,6,53,4],[87,10,53,8],[87,11,53,9,"lastLogDate"],[87,22,53,20],[87,24,53,22],[88,8,54,6],[89,8,55,6,"newStreak"],[89,17,55,15],[89,20,55,18],[89,21,55,19],[90,8,56,6,"awardedPoints"],[90,21,56,19],[90,24,56,22,"POINTS"],[90,44,56,28],[90,45,56,28,"POINTS"],[90,51,56,28],[90,52,56,29,"DAILY_STREAK"],[90,64,56,41],[91,6,57,4],[91,7,57,5],[91,13,57,11],[91,17,57,15],[91,18,57,16],[91,22,57,16,"isTodayDate"],[91,38,57,27],[91,39,57,27,"isTodayDate"],[91,50,57,27],[91,52,57,28,"lastLogDate"],[91,63,57,39],[91,64,57,40],[91,66,57,42],[92,8,58,6],[93,8,59,6,"newStreak"],[93,17,59,15],[93,20,59,18,"currentStreak"],[93,33,59,31],[93,36,59,34],[93,37,59,35],[94,8,60,6,"awardedPoints"],[94,21,60,19],[94,24,60,22,"POINTS"],[94,44,60,28],[94,45,60,28,"POINTS"],[94,51,60,28],[94,52,60,29,"DAILY_STREAK"],[94,64,60,41],[95,6,61,4],[96,6,63,4],[96,10,63,10,"newLongestStreak"],[96,26,63,26],[96,29,63,29,"Math"],[96,33,63,33],[96,34,63,34,"max"],[96,37,63,37],[96,38,63,38,"longestStreak"],[96,51,63,51],[96,53,63,53,"newStreak"],[96,62,63,62],[96,63,63,63],[97,6,65,4],[97,10,65,10,"updatedState"],[97,22,65,22],[97,25,65,25],[98,8,66,6],[98,11,66,9,"state"],[98,16,66,14],[98,17,66,15,"gamification"],[98,29,66,27],[99,8,67,6,"currentStreak"],[99,21,67,19],[99,23,67,21,"newStreak"],[99,32,67,30],[100,8,68,6,"longestStreak"],[100,21,68,19],[100,23,68,21,"newLongestStreak"],[100,39,68,37],[101,8,69,6,"lastLogDate"],[101,19,69,17],[101,21,69,19],[101,25,69,23,"Date"],[101,29,69,27],[101,30,69,28],[101,31,69,29],[101,32,69,30,"toISOString"],[101,43,69,41],[101,44,69,42],[101,45,69,43],[102,8,70,6,"points"],[102,14,70,12],[102,16,70,14,"state"],[102,21,70,19],[102,22,70,20,"gamification"],[102,34,70,32],[102,35,70,33,"points"],[102,41,70,39],[102,44,70,42,"awardedPoints"],[102,57,70,55],[103,8,71,6,"totalTransactions"],[103,25,71,23],[103,27,71,25,"state"],[103,32,71,30],[103,33,71,31,"gamification"],[103,45,71,43],[103,46,71,44,"totalTransactions"],[103,63,71,61],[103,66,71,64],[104,6,72,4],[104,7,72,5],[105,6,74,4],[105,12,74,10,"storageService"],[105,28,74,24],[105,29,74,24,"storageService"],[105,43,74,24],[105,44,74,25,"saveGamification"],[105,60,74,41],[105,61,74,42,"updatedState"],[105,73,74,54],[105,74,74,55],[106,6,75,4],[106,13,75,11,"updatedState"],[106,25,75,23],[107,4,76,2],[107,5,76,3],[108,4,76,3],[108,21,76,3,"_x3"],[108,24,76,3],[108,26,76,3,"_x4"],[108,29,76,3],[109,6,76,3],[109,13,76,3,"_ref5"],[109,18,76,3],[109,19,76,3,"apply"],[109,24,76,3],[109,31,76,3,"arguments"],[109,40,76,3],[110,4,76,3],[111,2,76,3],[111,5,77,0],[111,6,77,1],[112,2,79,0],[112,6,79,6,"gamificationSlice"],[112,23,79,23],[112,26,79,26],[112,30,79,26,"createSlice"],[112,45,79,37],[112,46,79,37,"createSlice"],[112,57,79,37],[112,59,79,38],[113,4,80,2,"name"],[113,8,80,6],[113,10,80,8],[113,24,80,22],[114,4,81,2,"initialState"],[114,16,81,14],[115,4,82,2,"reducers"],[115,12,82,10],[115,14,82,12],[115,15,82,13],[115,16,82,14],[116,4,83,2,"extraReducers"],[116,17,83,15],[116,19,83,18,"builder"],[116,26,83,25],[116,30,83,30],[117,6,84,4,"builder"],[117,13,84,11],[117,14,85,7,"addCase"],[117,21,85,14],[117,22,85,15,"loadGamification"],[117,38,85,31],[117,39,85,32,"fulfilled"],[117,48,85,41],[117,50,85,43],[117,51,85,44,"state"],[117,56,85,49],[117,58,85,51,"action"],[117,64,85,57],[117,69,85,62],[118,8,86,8],[118,15,86,15,"action"],[118,21,86,21],[118,22,86,22,"payload"],[118,29,86,29],[119,6,87,6],[119,7,87,7],[119,8,87,8],[119,9,88,7,"addCase"],[119,16,88,14],[119,17,88,15,"awardPoints"],[119,28,88,26],[119,29,88,27,"fulfilled"],[119,38,88,36],[119,40,88,38],[119,41,88,39,"state"],[119,46,88,44],[119,48,88,46,"action"],[119,54,88,52],[119,59,88,57],[120,8,89,8],[120,15,89,15,"action"],[120,21,89,21],[120,22,89,22,"payload"],[120,29,89,29],[121,6,90,6],[121,7,90,7],[121,8,90,8],[121,9,91,7,"addCase"],[121,16,91,14],[121,17,91,15,"updateStreak"],[121,29,91,27],[121,30,91,28,"fulfilled"],[121,39,91,37],[121,41,91,39],[121,42,91,40,"state"],[121,47,91,45],[121,49,91,47,"action"],[121,55,91,53],[121,60,91,58],[122,8,92,8],[122,15,92,15,"action"],[122,21,92,21],[122,22,92,22,"payload"],[122,29,92,29],[123,6,93,6],[123,7,93,7],[123,8,93,8],[124,4,94,2],[125,2,95,0],[125,3,95,1],[125,4,95,2],[126,2,97,0],[126,6,97,0,"_default"],[126,14,97,0],[126,17,97,15,"gamificationSlice"],[126,34,97,32],[126,35,97,33,"reducer"],[126,42,97,40],[127,0,97,41],[127,3]],"functionMap":{"names":["<global>","createAsyncThunk$argument_1","createSlice$argument_0.extraReducers","builder.addCase$argument_1","builder.addCase.addCase$argument_1","builder.addCase.addCase.addCase$argument_1"],"mappings":"AAA;ECoB;GDG;ECK;GDY;ECK;GD8B;iBEO;2CCE;ODE;sCEC;OFE;uCGC;OHE;GFC"},"hasCjsExports":false},"type":"js/module"}]}